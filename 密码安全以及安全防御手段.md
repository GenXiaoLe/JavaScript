### 账号密码安全相关

#### 密码泄露的渠道
- 数据库被盗
- 服务器被入侵
- 通讯被窃听
- 内部人员盗取数据

#### 具体防御手段
- 严禁明文存储
- 单向变换
- 变换复杂度要求
- 密码复杂度要求
- 加盐提高密码复杂度
- https传输
- 频次限制
- 前端加密

#### md5&salt

##### 一些情况的讨论

- 两次或多次md5无法使加密更加可靠

- 不能只在数据库加盐，需要在后端代码里在定义常量盐，提高安全性，即使在数据库泄露之后，密码依旧无法反推

- 不能完全依靠加盐来保护密码，对于用户密码的输入也应该有复杂度要求

##### 具体加盐方式
```js 

// 如果数据库里没有设定盐

// sql 表示数据库语句

// 去过没有盐 则生成一个盐，先用盐字段对密码加密， 再加到数据库的salt字段中
if (res.salt === null) {
  const salt = Math.random() * 99999 + new Date().getTime()
  
  res = await query(sql, [salt, encryptPassword(salt, password), username])
} else {
  console.log('has salt')
  // 有盐的情况直接进行操作
}

```

#### 人机验证&验证码
> 主要防止机器人之类恶意注册或者其他恶意请求

##### 验证码验证
后端生成一个验证码图片，并把相应字符存在session中，并将图片发送给前端，在用户发送过来的时候对比验证码
